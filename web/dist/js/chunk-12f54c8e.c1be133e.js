(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12f54c8e"],{"0bf7":function(t,e,a){},"10ac":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form-validate",{ref:"observer"},[a("page-header-wrapper",[a("a-card",{staticClass:"card",attrs:{title:"Base Information",bordered:!1}},[a("form-item-validate",{attrs:{label:"Name",vid:"name",required:""}},[a("a-input",{attrs:{disabled:t.disabled()},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),"edit"==t.post_type?a("a-card",{staticClass:"card",staticStyle:{width:"auto",overflow:"auto"},attrs:{title:"Permissions",bordered:!1}},[a("a-spin",{attrs:{spinning:t.updateing}},[a("table",{attrs:{cellpadding:"10",bordercolor:"gray",bgcolor:"white",border:"1",width:"auto"}},t._l(t.permissionData,(function(e,n){return a("tbody",{key:n,staticClass:"whitespace-no-wrap bg-gray-100"},[a("tr",[a("td",{staticClass:"py-4 ",attrs:{colspan:"10"}},[a("span",{staticClass:"uppercase font-bold"},[t._v(t._s(n))])])]),a("tr",t._l(e,(function(e){return a("td",{key:e.id,staticClass:"py-4 "},[a("a-checkbox",{attrs:{disabled:t.disabled()},on:{change:function(a){return t.onClick(e)}},model:{value:e.check,callback:function(a){t.$set(e,"check",a)},expression:"data.check"}},[a("span",{},[t._v(t._s(e.name))])])],1)})),0)])})),0)])],1):t._e(),"edit"==t.post_type?a("a-row",[a("a-col",{attrs:{span:12}},[t.$auth("delete_group")?a("a-popconfirm",{attrs:{title:"Are you sure delete?",okText:"Yes",cancelText:"No"},on:{confirm:t.onDelete}},[a("a-button",{attrs:{href:"javascript:;",type:"danger"}},[t._v("Delete")])],1):t._e()],1),a("a-col",{staticClass:"text-right",attrs:{span:12}},[a("a-button",{directives:[{name:"action",rawName:"v-action:change_group",arg:"change_group"}],attrs:{type:"primary",loading:t.updateing,"html-type":"submit"},on:{click:t.submit}},[t._v(" Submit ")])],1)],1):t._e(),"add"==t.post_type?a("a-row",[a("a-col",{staticClass:"text-right",attrs:{span:24}},[a("a-button",{directives:[{name:"action",rawName:"v-action:add_group",arg:"add_group"}],attrs:{type:"primary",loading:t.updateing,"html-type":"submit"},on:{click:t.submit}},[t._v(" Submit ")])],1)],1):t._e()],1)],1)},i=[],r=(a("7db0"),a("d81d"),a("13d5"),a("b0c0"),a("d3b7"),a("ac1f"),a("5319"),a("2af9")),o=a("cc5e"),s=(a("c1df"),a("2ef0")),c=a.n(s),u={components:{FormValidate:r["c"],FormItemValidate:r["b"]},props:{post_type:{type:String,default:"edit"}},data:function(){var t=this;return{loading:!1,updateing:!1,disabled:function(){return("add"!=t.post_type||!t.$auth("add_group"))&&("edit"!=t.post_type||!t.$auth("change_group"))},form:{},permission:[],permissionData:[]}},mounted:function(){"edit"==this.post_type&&this.getRoleData()},methods:{initRole:function(t,e){if(t){var a=c.a.intersectionBy(t.permissions,e,"id"),n=e.map((function(t){return a.find((function(e){return t.id===e.id}))?Object.assign(t,{check:!0}):Object.assign(t,{check:!1})}));this.permissionData=n.reduce((function(t,e){return e.name=e.name.replace("group","role"),e.content_type.model=e.content_type.model.replace("group","role"),t[e.content_type.model]=t[e.content_type.model]||[],t[e.content_type.model].push(e),t}),{})}},getRoleData:function(){var t=this;this.loading=!0,Object(o["c"])(this.$route.params.id).then((function(e){var a=e.result,n=a.data,i=a.extra;t.form=Object.assign({},n),t.permission=Object.assign([],i.permission),t.initRole(t.form,t.permission)})).finally((function(){t.loading=!1}))},submit:function(){var t=this;this.updateing=!0;var e=Object.assign({},this.form,{});"edit"==this.post_type?Object(o["e"])(this.$route.params.id,e).then((function(e){var a=e.result,n=a.data,i=a.extra;t.form=Object.assign({},n),t.extra=i})).catch((function(e){e.response&&t.$refs.observer.checkError(e)})).finally((function(){t.updateing=!1})):"add"==this.post_type&&Object(o["a"])(this.form).then((function(e){t.$router.replace({name:"RoleDetail",params:{id:e.result.data.id}})})).catch((function(e){e.response&&t.$refs.observer.setErrors(e)})).finally((function(){t.updateing=!1}))},updatePermission:function(t){var e=this;this.updateing=!0,Object(o["e"])(this.$route.params.id,{permission:t.id}).then((function(t){var a=t.result,n=a.data,i=a.extra;e.form=Object.assign({},n),e.permission=Object.assign([],i.permission),e.initRole(e.form,e.permission)})).finally((function(){e.updateing=!1}))},onClick:function(t){this.updatePermission(t)},onDelete:function(){var t=this;this.updateing=!0,Object(o["b"])(this.$route.params.id).then((function(){t.$router.go(-1)})).finally((function(){t.updateing=!1}))}}},d=u,l=(a("3f02"),a("2877")),p=Object(l["a"])(d,n,i,!1,null,"7bf4e39a",null);e["a"]=p.exports},"3f02":function(t,e,a){"use strict";var n=a("0bf7"),i=a.n(n);i.a},"8ed1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("index",{attrs:{post_type:"add"}})},i=[],r=a("10ac"),o={components:{Index:r["a"]}},s=o,c=a("2877"),u=Object(c["a"])(s,n,i,!1,null,null,null);e["default"]=u.exports},cc5e:function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return s})),a.d(e,"e",(function(){return c})),a.d(e,"b",(function(){return u}));var n=a("365c"),i=a("b775");function r(t){return Object(i["b"])({url:n["a"].Role,method:"get",params:t})}function o(t){return Object(i["b"])({url:n["a"].Role+"".concat(t,"/"),method:"get"})}function s(t){return Object(i["b"])({url:n["a"].Role,method:"post",data:t}).then(n["e"]).catch(n["d"])}function c(t,e){return Object(i["b"])({url:n["a"].Role+"".concat(t,"/"),method:"patch",data:e}).then(n["i"]).catch(n["h"])}function u(t,e){return Object(i["b"])({url:n["a"].Role+"".concat(t,"/"),method:"delete"}).then(n["g"]).catch(n["f"])}}}]);